title: CH7链接
author: Jiahao Wu
categories: 深入理解计算机系统
date: 2021-01-14 15:38:00
tags:
---
# **链接**

链接（linking）是将各种代码和数据片段收集并组合成一个单一文件的过程，这个文件可被加载（复制）到内存并执行。链接可以执行于编译时（compile time），也就是在源代码被翻译成机器代码时；也可以执行于加载时（load time），也就是在程序被加载器（loader）加载到内存系统执行时；甚至执行于运行时（run time），也就是在程序被加载器（loader）加载到内存并执行时；甚至于运行时，也就是由应用程序来执行。在早期的计算机系统中，链接是手动执行的。在现代系统中，链接时由叫做连接器（linker）程序自动执行的。  

## **编译器驱动程序**

sum.c、main.c  
预处理器将main.c翻译成一个ASCII码的中间文件main.i，然后编译器将main.i翻译成ASCII汇编语言文件main.s，然后驱动程序运行汇编器，将main.s翻译成一个可重定位目标文件main.o。  
sum.c->sum.i->sum.s->sum.o  
运行链接器程序ld将main.o、sum.o以及一些必要的系统目标文件组合起来，创建一个可执行目标文件prog。

## **静态链接**

为了构造可执行文件，链接器必须完成两个主要任务：符号解析、重定位。  

## **目标文件**

三种形式：可重定位目标文件（包含二进制代码和数据，其形式可以在编译时与其他可重定位目标文件合并起来，生成一个可执行目标文件）、可执行目标文件（包含二进制代码和数据，可以直接被复制到内存并执行）、共享目标文件（一种特殊类型的可重定位目标文件，可以在加载或者运行时加载进内存并链接）。

## **可重定位目标文件**

## **符号和符号表**

每个可重定位目标模块m有一个符号表，包含：  
- 由m模块定义并能被其他模块引用的全局符号。  
- 由其他模块定义并能被模块m引用的全局符号。  
- 只被模块m定义和引用的局部符号。  

## **符号解析**
