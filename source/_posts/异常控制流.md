title: 异常控制流
author: Jiahao Wu
tags:
  - 操作系统
categories:
  - 操作系统
date: 2021-03-18 16:08:00
---
# 异常控制流

最近看中断、异常好像不同的地方的定义不太一样，这里总结一下，以免自己以后又忘记了。  
首先我们根据CSAPP来定义，有4中不同的异常，分别是中断、陷阱、故障、终止。  

1. **中断**  
这里的中断我们可以称为硬中断，它是异步的，是来自处理器外部IO设备的信号导致的。硬件中断不是任何一条指令导致的，从这个意义上来说，它是异步的。中断一般由中断处理程序处理。  
每当中断被激活时，都会跳转到中断向量表（由CPU定义），这中间保存了各种中断的中断处理函数的地址，然后找到对应的中断处理函数，进行处理。  
注：这里的中断指的是硬中断，还有一种软中断，即由指令导致的中断，但是我们不将它归类为中断。  
2. **陷阱（系统调用）**  
陷阱是有意的异常，提供了用户态到内核态之间的接口，叫做系统调用，通过syscall指令来实现。执行syscall会跳转到异常处理程序（陷阱处理程序），执行相关的系统调用，然后再将控制返回到调用处。  
具体：根据系统调用号，从系统调用表中找到对应的系统调用函数，然后执行相应操作。  
3. **故障**  
故障是由错误引起的，但是程序能够处理的一种异常。当发生故障时候，控制权通常交由故障处理程序，如果能够处理这个故障，执行完毕后控制权返回到触发故障的指令；如果不能修复这个故障，处理程序返回到内核的abort例程，abort例程会终止引起故障的程序。  
缺页异常就是常见的故障。  
4. **终止**  
终止是不可恢复的致命错误造成的结果，通常是一些硬件错误。  

上述只有中断时异步的，其他都是同步的。